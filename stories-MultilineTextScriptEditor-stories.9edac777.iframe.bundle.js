"use strict";(self.webpackChunkscript_editor=self.webpackChunkscript_editor||[]).push([[5260],{"./node_modules/.pnpm/@babel+runtime@7.23.2/node_modules/@babel/runtime/helpers/esm/classCallCheck.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}__webpack_require__.d(__webpack_exports__,{Z:function(){return _classCallCheck}})},"./node_modules/.pnpm/@babel+runtime@7.23.2/node_modules/@babel/runtime/helpers/esm/createClass.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Z:function(){return _createClass}});var _toPropertyKey_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.23.2/node_modules/@babel/runtime/helpers/esm/toPropertyKey.js");function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,(0,_toPropertyKey_js__WEBPACK_IMPORTED_MODULE_0__.Z)(descriptor.key),descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}},"./src/stories/MultilineTextScriptEditor.stories.ts":function(module,__webpack_exports__,__webpack_require__){__webpack_require__.a(module,(async function(__webpack_handle_async_dependencies__,__webpack_async_result__){try{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Editor:function(){return Editor},__namedExportsOrder:function(){return __namedExportsOrder}});var _Editor$parameters,_Editor$parameters2,_Editor$parameters2$d,D_repo_script_editor_node_modules_pnpm_babel_runtime_7_23_2_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.23.2/node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),_components_TextScriptEditorMultiline__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/components/TextScriptEditorMultiline.tsx"),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_components_TextScriptEditorMultiline__WEBPACK_IMPORTED_MODULE_0__]),meta={title:"TextScriptEditorMultiline",component:(_components_TextScriptEditorMultiline__WEBPACK_IMPORTED_MODULE_0__=(__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__)[0]).ZP,parameters:{},tags:["autodocs"],argTypes:{}};__webpack_exports__.default=meta;var Editor={args:{debug:!0,rawJSON:{triggers:[],isProtected:!0,conditions:[{operator:"==",operandType:"boolean"},!0,!0],actions:[],name:"test",parent:null,key:"",order:0},scriptId:"",defaultReturnType:"unitType",onError:function onError(e){console.log(e)},onSuccess:function onSuccess(str){console.log(str)},extraSuggestions:{unitType:[{label:"astronaut",kind:1,insertTextRules:4,insertText:"astronaut",detail:"astronaut",range:{startLineNumber:0,endLineNumber:0,startColumn:0,endColumn:0},sortText:"a"}]}}};Editor.parameters=(0,D_repo_script_editor_node_modules_pnpm_babel_runtime_7_23_2_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_1__.Z)((0,D_repo_script_editor_node_modules_pnpm_babel_runtime_7_23_2_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_1__.Z)({},Editor.parameters),{},{docs:(0,D_repo_script_editor_node_modules_pnpm_babel_runtime_7_23_2_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_1__.Z)((0,D_repo_script_editor_node_modules_pnpm_babel_runtime_7_23_2_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_1__.Z)({},null===(_Editor$parameters=Editor.parameters)||void 0===_Editor$parameters?void 0:_Editor$parameters.docs),{},{source:(0,D_repo_script_editor_node_modules_pnpm_babel_runtime_7_23_2_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_1__.Z)({originalSource:"{\n  args: {\n    debug: true,\n    rawJSON: {\n      triggers: [],\n      isProtected: true,\n      conditions: [{\n        operator: \"==\",\n        operandType: \"boolean\"\n      }, true, true],\n      actions: [],\n      name: 'test',\n      parent: null,\n      key: '',\n      order: 0\n    },\n    scriptId: '',\n    defaultReturnType: 'unitType',\n    onError: e => {\n      console.log(e);\n    },\n    onSuccess: str => {\n      console.log(str);\n    },\n    extraSuggestions: {\n      unitType: [{\n        label: \"astronaut\",\n        kind: 1,\n        insertTextRules: 4,\n        insertText: \"astronaut\",\n        detail: \"astronaut\",\n        range: {\n          startLineNumber: 0,\n          endLineNumber: 0,\n          startColumn: 0,\n          endColumn: 0\n        },\n        sortText: 'a'\n      }]\n    }\n  }\n}"},null===(_Editor$parameters2=Editor.parameters)||void 0===_Editor$parameters2||null===(_Editor$parameters2$d=_Editor$parameters2.docs)||void 0===_Editor$parameters2$d?void 0:_Editor$parameters2$d.source)})});var __namedExportsOrder=["Editor"];__webpack_async_result__()}catch(e){__webpack_async_result__(e)}}))},"./src/components/TextScriptEditorMultiline.tsx":function(module,__webpack_exports__,__webpack_require__){__webpack_require__.a(module,(async function(__webpack_handle_async_dependencies__,__webpack_async_result__){try{__webpack_require__.d(__webpack_exports__,{bC:function(){return replaceFunctionWithType}});var D_repo_script_editor_node_modules_pnpm_babel_runtime_7_23_2_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.23.2/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js"),D_repo_script_editor_node_modules_pnpm_babel_runtime_7_23_2_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.23.2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),D_repo_script_editor_node_modules_pnpm_babel_runtime_7_23_2_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.23.2/node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),_monaco_editor_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/@monaco-editor+react@4.6.0_monaco-editor@0.44.0_react-dom@18.2.0_react@18.2.0/node_modules/@monaco-editor/react/dist/index.mjs"),_constants_string__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./src/constants/string.ts"),_constants_monacoConfig__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/constants/monacoConfig.ts"),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),script_parser__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/.pnpm/script-parser@0.0.56/node_modules/script-parser/dist/index.js"),_utils_actions__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/utils/actions.ts"),_TextScriptEditor__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/components/TextScriptEditor.tsx"),_utils_rawJSONGenerator__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/utils/rawJSONGenerator.ts"),_utils_triggers__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/utils/triggers.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js"),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_utils_actions__WEBPACK_IMPORTED_MODULE_4__,_TextScriptEditor__WEBPACK_IMPORTED_MODULE_5__,_utils_rawJSONGenerator__WEBPACK_IMPORTED_MODULE_6__,_utils_triggers__WEBPACK_IMPORTED_MODULE_7__]);function formatJSON(){var val=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var res=JSON.parse(val);return JSON.stringify(res,null,2)}catch(_unused){var errorJson={error:"invalid ".concat(val)};return JSON.stringify(errorJson,null,2)}}[_utils_actions__WEBPACK_IMPORTED_MODULE_4__,_TextScriptEditor__WEBPACK_IMPORTED_MODULE_5__,_utils_rawJSONGenerator__WEBPACK_IMPORTED_MODULE_6__,_utils_triggers__WEBPACK_IMPORTED_MODULE_7__]=__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__;var replaceFunctionWithType=function replaceFunctionWithType(a){return a.map((function(o){var newObject={};return Object.keys(o).forEach((function(k){"function"===k?newObject.type=o[k]:newObject[k]=o[k]})),newObject}))},multiScopesStrings=["else"],TextScriptEditorMultiline=function TextScriptEditorMultiline(_ref){var onSuccess=_ref.onSuccess,rawJSON=(_ref.onError,_ref.rawJSON),extraData=_ref.extraData,extraSuggestions=_ref.extraSuggestions,_ref$debug=_ref.debug,debug=void 0!==_ref$debug&&_ref$debug,_ref$defaultValue=_ref.defaultValue,defaultValue=void 0===_ref$defaultValue?"":_ref$defaultValue,_ref$defaultReturnTyp=_ref.defaultReturnType,defaultReturnType=void 0===_ref$defaultReturnTyp?"":_ref$defaultReturnTyp,_useState=(0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(""),_useState2=(0,D_repo_script_editor_node_modules_pnpm_babel_runtime_7_23_2_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_9__.Z)(_useState,2),parseStr=_useState2[0],setParseStr=_useState2[1],_useState3=(0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(""),_useState4=(0,D_repo_script_editor_node_modules_pnpm_babel_runtime_7_23_2_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_9__.Z)(_useState3,2),setConvertedStr=(_useState4[0],_useState4[1]),textRef=(0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(void 0),editorRef=(0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(void 0),monacoRef=(0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(void 0),disposableRef=(0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)([]),stringToAction=function stringToAction(v){var _editorRef$current,_editorRef$current$ge;if(null===(_editorRef$current=editorRef.current)||void 0===_editorRef$current||null===(_editorRef$current$ge=_editorRef$current.getModel())||void 0===_editorRef$current$ge||_editorRef$current$ge.setEOL(0),""===v)null==onSuccess||onSuccess(void 0),setParseStr(""),setConvertedStr(""),monacoRef.current.editor.setModelMarkers(editorRef.current.getModel(),"owner",[]);else{var _textRef$current,name=rawJSON.name,key=rawJSON.key,order=rawJSON.order,parent=rawJSON.parent,isProtected=rawJSON.isProtected,json=new _utils_rawJSONGenerator__WEBPACK_IMPORTED_MODULE_6__.Z({name:name,key:key,order:order,parent:parent,isProtected:isProtected}),splitLine=null==v?void 0:v.split("\n");if(splitLine){for(var movedString={currentString:"",nextLineString:""},monaco=monacoRef.current,model=editorRef.current.getModel(),_loop=function _loop(){try{var value="",clearStruct=!1;value=movedString.nextLineString+splitLine[i];var movedProps=(0,_utils_actions__WEBPACK_IMPORTED_MODULE_4__.W9)(value.trim());if(movedString.nextLineString=movedProps.nextLineString,(value=movedProps.currentString.trim()).startsWith("{")&&(value=value.slice(1,value.length),json.goToNextKey()),value.endsWith("}")&&(value=value.slice(0,value.length-1),clearStruct=!0),multiScopesStrings.includes(value))return clearStruct=!1,0;if(""!==value){var _extraSuggestions;if(function isComment(s){return s.trim().startsWith("//")}(value))return json.insertUnusedComment(value.replace("//","").trim()),0;if(function isTrigger(s){return s.trim().startsWith("@")}(value))return json.insertTriggers(script_parser__WEBPACK_IMPORTED_MODULE_3__.parser.parse(value)),0;(function isDisabled(s){return s.trim().startsWith("--")})(value)&&((value=value.replace("--","")).trim().startsWith("{")||value.trim().endsWith("}")||json.insertUnusedDisabled());var funcProps=(0,_utils_actions__WEBPACK_IMPORTED_MODULE_4__.qn)(value,value.length-1);_utils_rawJSONGenerator__WEBPACK_IMPORTED_MODULE_6__.E[funcProps.functionName]&&json.setStruct(funcProps.functionName),null==extraSuggestions||null===(_extraSuggestions=extraSuggestions[defaultReturnType||"_"])||void 0===_extraSuggestions||_extraSuggestions.forEach((function(suggest){if(value)switch(defaultReturnType){case"unitType":case"script":value=value.replaceAll(new RegExp("\\b".concat(suggest.insertText,'\\b(?![^"]*")'),"g"),'"'.concat(suggest.detail,'"'))}}));var output=script_parser__WEBPACK_IMPORTED_MODULE_3__.parser.parse(value),processedOutput="object"==typeof output?(0,_utils_actions__WEBPACK_IMPORTED_MODULE_4__.bW)(output,extraData):output;json.insertAction(processedOutput,extraData)}clearStruct&&json.removeStruct(extraData)}catch(e){}},i=0;i<splitLine.length;i++)_loop();monaco.editor.setModelMarkers(model,"owner",[])}var jsonData=json.generateRawJSON();jsonData.actions=replaceFunctionWithType(jsonData.actions),setParseStr(jsonData),setConvertedStr((0,script_parser__WEBPACK_IMPORTED_MODULE_3__.actionToString)({o:jsonData,parentKey:"",defaultReturnType:defaultReturnType||"",gameData:{unitTypes:{}}})),null!=textRef&&null!==(_textRef$current=textRef.current)&&void 0!==_textRef$current&&_textRef$current.value&&(textRef.current.value=JSON.stringify(jsonData)),null==onSuccess||onSuccess(jsonData)}},init=function init(monaco){var _provideSignatureHelp;disposableRef.current.push(monaco.languages.setMonarchTokensProvider(_constants_string__WEBPACK_IMPORTED_MODULE_10__.I,_constants_monacoConfig__WEBPACK_IMPORTED_MODULE_1__.DJ)),disposableRef.current.push(monaco.languages.setLanguageConfiguration(_constants_string__WEBPACK_IMPORTED_MODULE_10__.I,_constants_monacoConfig__WEBPACK_IMPORTED_MODULE_1__.DN)),disposableRef.current.push(monaco.languages.registerCompletionItemProvider(_constants_string__WEBPACK_IMPORTED_MODULE_10__.I,{triggerCharacters:_TextScriptEditor__WEBPACK_IMPORTED_MODULE_5__.Xn,provideCompletionItems:function provideCompletionItems(model,position,context,token){var _Object$keys,word=model.getWordUntilPosition(position),range={startLineNumber:position.lineNumber,endLineNumber:position.lineNumber,startColumn:word.startColumn,endColumn:word.endColumn},cursorPos=position.column-1,code=model.getLineContent(position.lineNumber),suggestionType=(0,_utils_actions__WEBPACK_IMPORTED_MODULE_4__.EP)(code,Math.max(0,cursorPos-1)),needBrackets=function needBrackets(obj){return suggestionType===_constants_monacoConfig__WEBPACK_IMPORTED_MODULE_1__.O6&&!script_parser__WEBPACK_IMPORTED_MODULE_3__.noBracketsFuncs.includes(obj.key)},inputProps=(0,_utils_actions__WEBPACK_IMPORTED_MODULE_4__.TC)((0,_utils_actions__WEBPACK_IMPORTED_MODULE_4__.qn)(code,Math.max(0,cursorPos-1))),isTrigger=code.trim().startsWith("@"),suggestions=(0,_utils_actions__WEBPACK_IMPORTED_MODULE_4__.k6)(code,Math.max(0,cursorPos-1))?[]:isTrigger?(0,_utils_triggers__WEBPACK_IMPORTED_MODULE_7__.s)().map((function(obj,orderIdx){return{label:obj.key,kind:monaco.languages.CompletionItemKind.Event,insertText:obj.key,sortText:"a",documentation:obj.title,insertTextRules:4,detail:obj.title,range:range}})):(0,_utils_actions__WEBPACK_IMPORTED_MODULE_4__.Sv)().map((function(obj,orderIdx){var _aliasTable,_aliasTable2,_data$fragments$filte;return{label:"".concat(null!==(_aliasTable=script_parser__WEBPACK_IMPORTED_MODULE_3__.aliasTable[obj.key])&&void 0!==_aliasTable?_aliasTable:obj.key).concat(needBrackets(obj)?"(":"").concat(suggestionType===_constants_monacoConfig__WEBPACK_IMPORTED_MODULE_1__.O6?obj.data.fragments.filter((function(v){return"variable"===v.type})).map((function(v,idx){return"".concat(v.field,":").concat(v.dataType)})).join(", "):"").concat(needBrackets(obj)?")":"",": ").concat(obj.data.category),kind:suggestionType===_constants_monacoConfig__WEBPACK_IMPORTED_MODULE_1__.O6?monaco.languages.CompletionItemKind.Function:monaco.languages.CompletionItemKind.Property,insertText:"".concat(null!==(_aliasTable2=script_parser__WEBPACK_IMPORTED_MODULE_3__.aliasTable[obj.key])&&void 0!==_aliasTable2?_aliasTable2:obj.key).concat(needBrackets(obj)?"(":"").concat(suggestionType===_constants_monacoConfig__WEBPACK_IMPORTED_MODULE_1__.O6?obj.data.fragments.filter((function(v){return"variable"===v.type})).map((function(v,idx){return"${".concat(idx+1,":").concat(v.field,"}")})).join(", "):"").concat(needBrackets(obj)?")":""),sortText:(0,_utils_actions__WEBPACK_IMPORTED_MODULE_4__._t)(obj,inputProps,defaultReturnType),documentation:null===(_data$fragments$filte=obj.data.fragments.filter((function(v){return"constant"===v.type}))[0])||void 0===_data$fragments$filte?void 0:_data$fragments$filte.text,insertTextRules:4,detail:obj.title,range:range}})),extra=[];extraSuggestions&&(null===(_Object$keys=Object.keys(extraSuggestions))||void 0===_Object$keys||_Object$keys.forEach((function(key){(0,_utils_actions__WEBPACK_IMPORTED_MODULE_4__.qn)(code,Math.max(0,cursorPos-1)).functionName!==key&&key!==defaultReturnType||extraSuggestions[key].forEach((function(suggestion){suggestion.range=range,extra.push(suggestion)}))})));return{incomplete:!0,suggestions:extraSuggestions?extra.concat(suggestions):suggestions}}})),disposableRef.current.push(monaco.languages.registerSignatureHelpProvider(_constants_string__WEBPACK_IMPORTED_MODULE_10__.I,{signatureHelpTriggerCharacters:_TextScriptEditor__WEBPACK_IMPORTED_MODULE_5__.R4,provideSignatureHelp:(_provideSignatureHelp=(0,D_repo_script_editor_node_modules_pnpm_babel_runtime_7_23_2_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_11__.Z)((0,D_repo_script_editor_node_modules_pnpm_babel_runtime_7_23_2_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_12__.Z)().mark((function _callee(model,position,token,context){var cursorPos,code,functionProps,targetAction,targetFrag,signatures;return(0,D_repo_script_editor_node_modules_pnpm_babel_runtime_7_23_2_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_12__.Z)().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return cursorPos=position.column-1,code=model.getLineContent(position.lineNumber),functionProps=(0,_utils_actions__WEBPACK_IMPORTED_MODULE_4__.qn)(code,Math.max(0,cursorPos-1)),targetAction=(0,_utils_actions__WEBPACK_IMPORTED_MODULE_4__.Sv)().find((function(obj){var _aliasTable3;return(null!==(_aliasTable3=script_parser__WEBPACK_IMPORTED_MODULE_3__.aliasTable[obj.key])&&void 0!==_aliasTable3?_aliasTable3:obj.key)===functionProps.functionName})),targetFrag=null==targetAction?void 0:targetAction.data.fragments.filter((function(frag){return"variable"===frag.type})),signatures=targetAction&&"undefined"!==functionProps.functionName?[{label:"",documentation:{value:"".concat(functionProps.functionName,"(").concat(null==targetFrag?void 0:targetFrag.map((function(frag,idx){var _frag$extraData;return"".concat(idx===functionProps.functionParametersOffset?"**":"").concat(frag.field,": ").concat((null===(_frag$extraData=frag.extraData)||void 0===_frag$extraData?void 0:_frag$extraData.dataType)||frag.dataType).concat(idx===functionProps.functionParametersOffset?"**":"")})),")")},parameters:targetFrag.map((function(frag){return{label:"",documentation:frag.filed}}))}]:[],_context.abrupt("return",{dispose:function dispose(){},value:{activeParameter:functionProps.functionParametersOffset,activeSignature:0,signatures:signatures}});case 7:case"end":return _context.stop()}}),_callee)}))),function provideSignatureHelp(_x,_x2,_x3,_x4){return _provideSignatureHelp.apply(this,arguments)})}))};return(0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)((function(){monacoRef.current&&(disposableRef.current.forEach((function(ref){ref.dispose()})),init(monacoRef.current))}),[defaultReturnType,extraSuggestions,rawJSON.key]),(0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)((function(){var _editorRef$current2;null==editorRef||null===(_editorRef$current2=editorRef.current)||void 0===_editorRef$current2||_editorRef$current2.setValue(defaultValue)}),[rawJSON.key]),(0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)((function(){return function(){disposableRef.current.forEach((function(ref){ref.dispose()}))}}),[]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("div",{style:{display:"flex",width:"100%"},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_monaco_editor_react__WEBPACK_IMPORTED_MODULE_0__.ML,{language:_constants_string__WEBPACK_IMPORTED_MODULE_10__.I,theme:"vs-dark",options:{minimap:{enabled:!1}},height:"100vh",beforeMount:function beforeMount(monaco){monacoRef.current=monaco,monaco.languages.register({id:_constants_string__WEBPACK_IMPORTED_MODULE_10__.I}),init(monaco)},onMount:function onMount(editor){var _editor$getModel;editorRef.current=editor,null===(_editor$getModel=editor.getModel())||void 0===_editor$getModel||_editor$getModel.setEOL(0),editor.setValue(defaultValue),stringToAction(defaultValue),editor.onDidPaste((function(e){}))},onChange:function onChange(v){stringToAction(v)}}),debug&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_monaco_editor_react__WEBPACK_IMPORTED_MODULE_0__.ML,{value:formatJSON(JSON.stringify(parseStr)),theme:"vs-dark",language:"JSON",height:"100vh",width:"30%",onChange:function onChange(v){try{var _editorRef$current3;null===(_editorRef$current3=editorRef.current)||void 0===_editorRef$current3||_editorRef$current3.setValue((0,script_parser__WEBPACK_IMPORTED_MODULE_3__.actionToString)({o:JSON.parse(v||""),defaultReturnType:defaultReturnType,parentKey:"",gameData:{unitTypes:{}}}))}catch(e){console.log(e)}}})]})};__webpack_exports__.ZP=TextScriptEditorMultiline;try{formatJSON.displayName="formatJSON",formatJSON.__docgenInfo={description:"",displayName:"formatJSON",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/TextScriptEditorMultiline.tsx#formatJSON"]={docgenInfo:formatJSON.__docgenInfo,name:"formatJSON",path:"src/components/TextScriptEditorMultiline.tsx#formatJSON"})}catch(__react_docgen_typescript_loader_error){}try{replaceFunctionWithType.displayName="replaceFunctionWithType",replaceFunctionWithType.__docgenInfo={description:"",displayName:"replaceFunctionWithType",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/TextScriptEditorMultiline.tsx#replaceFunctionWithType"]={docgenInfo:replaceFunctionWithType.__docgenInfo,name:"replaceFunctionWithType",path:"src/components/TextScriptEditorMultiline.tsx#replaceFunctionWithType"})}catch(__react_docgen_typescript_loader_error){}try{TextScriptEditorMultiline.displayName="TextScriptEditorMultiline",TextScriptEditorMultiline.__docgenInfo={description:"",displayName:"TextScriptEditorMultiline",props:{debug:{defaultValue:{value:"false"},description:"",name:"debug",required:!1,type:{name:"boolean"}},scriptId:{defaultValue:null,description:"",name:"scriptId",required:!0,type:{name:"string"}},rawJSON:{defaultValue:null,description:"",name:"rawJSON",required:!0,type:{name:"RawJSON"}},defaultValue:{defaultValue:{value:""},description:"",name:"defaultValue",required:!1,type:{name:"string"}},defaultReturnType:{defaultValue:{value:""},description:"",name:"defaultReturnType",required:!1,type:{name:"string"}},extraSuggestions:{defaultValue:null,description:"",name:"extraSuggestions",required:!1,type:{name:"Record<string, CompletionItem[]>"}},extraData:{defaultValue:null,description:"",name:"extraData",required:!1,type:{name:"ExtraDataProps"}},onError:{defaultValue:null,description:"",name:"onError",required:!1,type:{name:"(({ e, output }: { e: string[]; output: string; }) => void)"}},onSuccess:{defaultValue:null,description:"",name:"onSuccess",required:!1,type:{name:"((parserOutput: Record<string, any>) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/TextScriptEditorMultiline.tsx#TextScriptEditorMultiline"]={docgenInfo:TextScriptEditorMultiline.__docgenInfo,name:"TextScriptEditorMultiline",path:"src/components/TextScriptEditorMultiline.tsx#TextScriptEditorMultiline"})}catch(__react_docgen_typescript_loader_error){}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}}))},"./src/utils/rawJSONGenerator.ts":function(module,__webpack_exports__,__webpack_require__){__webpack_require__.a(module,(async function(__webpack_handle_async_dependencies__,__webpack_async_result__){try{__webpack_require__.d(__webpack_exports__,{E:function(){return STRUCTS},Z:function(){return RawJSONGenerator}});var D_repo_script_editor_node_modules_pnpm_babel_runtime_7_23_2_node_modules_babel_runtime_helpers_esm_classCallCheck_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.23.2/node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),D_repo_script_editor_node_modules_pnpm_babel_runtime_7_23_2_node_modules_babel_runtime_helpers_esm_createClass_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.23.2/node_modules/@babel/runtime/helpers/esm/createClass.js"),_components_TextScriptEditorMultiline__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/components/TextScriptEditorMultiline.tsx"),_actions__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/utils/actions.ts"),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_components_TextScriptEditorMultiline__WEBPACK_IMPORTED_MODULE_0__,_actions__WEBPACK_IMPORTED_MODULE_1__]);[_components_TextScriptEditorMultiline__WEBPACK_IMPORTED_MODULE_0__,_actions__WEBPACK_IMPORTED_MODULE_1__]=__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__;var SKIPS=["_startIdx","_variant"],STRUCTS={if:{type:"condition",conditions:null,then:[],else:[],_startIdx:1},forAllItems:{type:"forAllItems",itemGroup:null,actions:[],_startIdx:1},while:{type:"while",conditions:null,actions:[],_startIdx:1},repeat:{type:"repeat",count:null,actions:[],_startIdx:1},forAllEntities:{type:"forAllEntities",entityGroup:null,actions:[],_startIdx:1},forAllItemTypes:{type:"forAllItemTypes",itemTypeGroup:null,actions:[],_startIdx:1},forAllProjectiles:{type:"forAllProjectiles",projectileGroup:null,actions:[],_startIdx:1},forAllRegions:{type:"forAllRegions",regionGroup:null,actions:[],_startIdx:1},forAllUnitTypes:{type:"forAllUnitTypes",unitTypeGroup:null,actions:[],_startIdx:1},forAllPlayers:{type:"forAllPlayers",playerGroup:null,actions:[],_startIdx:1},for:{type:"for",_variant:null,actions:[],_startIdx:1},forAllDebris:{type:"forAllDebris",debrisGroup:null,actions:[],_startIdx:1},forAllUnits:{type:"forAllUnits",unitGroup:null,actions:[],_startIdx:1},forIn:{type:"forIn",_variant:null,actions:[],_startIdx:1}},RawJSONGenerator=function(){function RawJSONGenerator(_ref){var name=_ref.name,parent=_ref.parent,key=_ref.key,order=_ref.order,isProtected=_ref.isProtected;(0,D_repo_script_editor_node_modules_pnpm_babel_runtime_7_23_2_node_modules_babel_runtime_helpers_esm_classCallCheck_js__WEBPACK_IMPORTED_MODULE_2__.Z)(this,RawJSONGenerator),this._triggers=[],this._conditions=[{operator:"==",operandType:"boolean"},!0,!0],this._actions=[],this._unUsedComment=[],this._unUsedDisabled=[],this._name=void 0,this._parent=void 0,this._key=void 0,this._order=void 0,this._isProtected=void 0,this._nextStruct=[],this._name=name,this._parent=parent,this._key=key,this._order=order,this._isProtected=isProtected}return(0,D_repo_script_editor_node_modules_pnpm_babel_runtime_7_23_2_node_modules_babel_runtime_helpers_esm_createClass_js__WEBPACK_IMPORTED_MODULE_3__.Z)(RawJSONGenerator,[{key:"insertTriggers",value:function insertTriggers(trigger){this._triggers.push(trigger)}},{key:"getNextStruct",value:function getNextStruct(){return this._nextStruct}},{key:"insertComment",value:function insertComment(o){var comment=this._unUsedComment.pop();""!==comment&&void 0!==comment&&(o.comment=comment)}},{key:"insertDisabled",value:function insertDisabled(o){var disabled=this._unUsedDisabled.pop();void 0!==disabled&&(o.disabled=disabled)}},{key:"insertUnusedDisabled",value:function insertUnusedDisabled(){this._unUsedDisabled.push(!0)}},{key:"insertUnusedComment",value:function insertUnusedComment(comment){var forcePush=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._unUsedComment.length>0&&!0!==forcePush){var nowIdx=Math.max(this._unUsedComment.length-1,0);this._unUsedComment[nowIdx]+=(""!==this._unUsedComment[nowIdx]?"\n":"")+comment}else this._unUsedComment.push(comment)}},{key:"setStruct",value:function setStruct(key){this._nextStruct.push({currentKeyIdx:STRUCTS[key]._startIdx,struct:JSON.parse(JSON.stringify(STRUCTS[key]))}),this.insertUnusedComment("",!0),this.insertUnusedComment("",!0)}},{key:"goToNextKey",value:function goToNextKey(){this._nextStruct.length>0&&(this._nextStruct[this._nextStruct.length-1].currentKeyIdx+=1)}},{key:"removeStruct",value:function removeStruct(extraData){if(this._nextStruct.length>0)if(1===this._nextStruct.length){var o=(0,_actions__WEBPACK_IMPORTED_MODULE_1__.bW)(this._nextStruct[this._nextStruct.length-1].struct,extraData);this.insertComment(o),this.insertDisabled(o),this._actions.push(o),this._nextStruct=[]}else{var key=Object.keys(this._nextStruct[this._nextStruct.length-2].struct)[this._nextStruct[this._nextStruct.length-2].currentKeyIdx],nowObj=this._nextStruct[this._nextStruct.length-2].struct[key],action=this._nextStruct[this._nextStruct.length-1].struct;this.insertComment(action),this.insertDisabled(action),SKIPS.includes(key)||(null===nowObj?this._nextStruct[this._nextStruct.length-2].struct[key]=action:"object"==typeof nowObj&&Array.isArray(nowObj)&&nowObj.push("actions"===key?(0,_components_TextScriptEditorMultiline__WEBPACK_IMPORTED_MODULE_0__.bC)([action])[0]:action)),this._nextStruct=this._nextStruct.splice(this._nextStruct.length-2,1)}}},{key:"insertAction",value:function insertAction(action,extraData){var _this=this;if(this._nextStruct.length>0){var _ref2,key=Object.keys(this._nextStruct[this._nextStruct.length-1].struct)[this._nextStruct[this._nextStruct.length-1].currentKeyIdx],nowObj=this._nextStruct[this._nextStruct.length-1].struct[key];if("_variant"===key)Object.keys(action).forEach((function(k){SKIPS.includes(k)||(_this._nextStruct[_this._nextStruct.length-1].struct[k]=action[k])})),this._unUsedComment.length>0&&(this.insertComment(this._nextStruct[this._nextStruct.length-1].struct),this.insertDisabled(this._nextStruct[this._nextStruct.length-1].struct));else if(this.insertComment(action),this.insertDisabled(action),null===nowObj)this._nextStruct[this._nextStruct.length-1].struct[key]=null!==(_ref2=action[key])&&void 0!==_ref2?_ref2:action;else"object"==typeof nowObj&&Array.isArray(nowObj)&&nowObj.push("actions"===key?(0,_components_TextScriptEditorMultiline__WEBPACK_IMPORTED_MODULE_0__.bC)([action])[0]:action)}else{var newAction=action;this.insertComment(newAction),this.insertDisabled(newAction),this._actions.push((0,_actions__WEBPACK_IMPORTED_MODULE_1__.bW)(newAction,extraData))}}},{key:"generateRawJSON",value:function generateRawJSON(){return{isProtected:this._isProtected,triggers:this._triggers,conditions:this._conditions,actions:this._actions,name:this._name,parent:this._parent,key:this._key,order:this._order}}}]),RawJSONGenerator}();__webpack_async_result__()}catch(e){__webpack_async_result__(e)}}))},"./src/utils/triggers.ts":function(module,__webpack_exports__,__webpack_require__){__webpack_require__.a(module,(async function(__webpack_handle_async_dependencies__,__webpack_async_result__){try{__webpack_require__.d(__webpack_exports__,{s:function(){return getTriggers}});var axios__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/axios@1.6.0/node_modules/axios/lib/axios.js"),triggersCache=(await axios__WEBPACK_IMPORTED_MODULE_0__.Z.get("https://www.modd.io/api/editor-api/?game=two-houses&type=trigger")).data.message,getTriggers=function getTriggers(){return triggersCache};__webpack_async_result__()}catch(e){__webpack_async_result__(e)}}),1)}}]);